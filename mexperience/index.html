<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>mExperience</title>
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="css/theme.css">
    <link href="css/animate.css" rel="stylesheet" type="text/css"/>
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:700,300,600,800,400' rel='stylesheet' type='text/css'>

    <script type="text/javascript">


    </script>


</head>
<body>
    <!-- Open the output in a new blank tab (Click the arrow next to "Show Output" button) and resize the window to understand how the Bootstrap responsive grid system works. -->
    <div class="container">
        <nav class="navbar navbar-default">
            <div class="container-fluid">
                <!-- Brand and toggle get grouped for better mobile display -->
                <div class="navbar-header">
                    <a class="navbar-brand" href="index.html">
                        <img src="images/m-experience.png" alt="mExperience" width="80%" title="mExperience">
                    </a>
                </div>
            </div>
            <!-- /.container-fluid -->
        </nav>
    </div>

    <div class="col-md-12 mk-bg text-center"><br/>
        <h1 class="mk-dark-green"><b>GET YOUR DEALS ON MAGIC TUESDAY</b></h1>
        <h3 class="mk-dark-green">Experience Tuesday with your family like never before</h3>
    </div>

    <div class="col-md-12 mk-primary-bg">
        <div class="container">
            <div class="row display">
                <div class="col-sm-3">
                    <div class="form-group">
                        <input type="text" class="form-control typeahead" id="cuisine" placeholder="Cuisine">
                    </div>
                </div>

                <div class="col-sm-3">
                    <div class="form-group">
                        <input type="text" class="form-control typeahead" id="city" placeholder="City">
                    </div>
                </div>

                <div class="col-sm-3">
                    <div class="form-group">
                        <input type="text" class="form-control typeahead" id="locality" placeholder="Location">
                    </div>
                </div>

                <div class="col-sm-3">
                    <button id="get-suggestions" type="submit" class="btn btn-primary btn-block text-uppercase">Search now</button>
                </div>
            </div>
        </div>
    </div>

    <div class="container">
        <div class="row top-buffer">
            <div class="col-md-12 text-center">
                <H2>THIS IS HOW IT WORKS</H2>
            </div>
        </div>
    </div>

    <div class="container">
        <div class="row top-buffer">
            <div class="col-md-3 text-center">
                <img class="wow bounceIn" data-wow-delay="200ms" src="images/select.png" height="60" alt="Select option">

                <h3 class="primary-color">STEP 1</h3>
                <h4>SELECT</h4>
                Lorem ipsum dolor sit amet, adipisicing elit. Ad consectetur quibusdam, repudiandae est.
            </div>

            <div class="col-md-3 text-center">
                <img class="wow bounceIn" data-wow-delay="600ms" src="images/download.png" height="60" alt="Download">

                <h3 class="primary-color">STEP 2</h3>
                <h4>DOWNLOAD</h4>
                Lorem ipsum dolor sit amet, adipisicing elit. Ad consectetur quibusdam, repudiandae est.
            </div>

            <div class="col-md-3 text-center">
                <img class="wow bounceIn" data-wow-delay="1000ms" src="images/visit.png" height="60" alt="Visit the outlet">

                <h3 class="primary-color">STEP 3</h3>
                <h4>VISIT THE OUTLET</h4>
                Lorem ipsum dolor sit amet, adipisicing elit. Ad consectetur quibusdam, repudiandae est.
            </div>

            <div class="col-md-3 text-center">
                <img class="wow bounceIn" data-wow-delay="1400ms" data-wow-delay="200ms" src="images/share.png" height="60"
                     alt="Share">

                <h3 class="primary-color">STEP 4</h3>
                <h4>SHARE</h4>
                Lorem ipsum dolor sit amet, adipisicing elit. Ad consectetur quibusdam, repudiandae est.
            </div>
        </div>
    </div>


    <div class="col-md-12 mk-tertiary-bg top-buffer">
        <div class="container">
            <h2 class="text-center mk-white">CHECK OUT EXCLUSIVE MONEY-SAVING SPECIALS</h2>
            <!--Placeholder for landing page offers-->
            <div id="landing-page-offers" class="row top-buffer"></div>
        </div>
    </div>


    <div class="col-md-12 mk-tertiary-bg text-center">
        <button type="submit" class="btn btn-mk-green">SEE MORE VOUCHERS</button>
    </div>

    <div class="col-md-12 mk-tertiary-bg text-center"></div>


    <div class="col-md-12  top-buffer">
        <div class="container">
            <H2 class="text-center mk-gray">RESTAURANT THAT HAVE EXCLUSIVE DEALS</H2>
            <!--Placeholder for exclusive offers-->
            <div id="landing-page-exclusives" class="row top-buffer"></div>
        </div>
    </div>


    <div class="col-md-12  text-center">
        <button type="submit" class="btn btn-mk-pink">SEE MORE VOUCHERS</button>
    </div>

    <div class="col-md-12  text-center"></div>


    <div class="col-md-12 mk-primary-bg">
        <div class="container text-center ">
            <h4>mExperience@2015</h4>
        </div>
    </div>


    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/3.6.0/lodash.js"></script>
    <script src="js/wow.min.js"></script>
    <script src="js/reffer.js"></script>
    <script src="js/typeahead.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/data.js"></script>
    <script src="js/suggestions.js"></script>
    <script src="js/render.js"></script>
    <script src="js/api.js"></script>

    <script>
        jQuery(function() {
            var offersSource = new mExperience.offers.DataSource().initialize("https://spreadsheets.google.com/feeds/list/19aMSbuRSvaOOOjTCuXcIP3Wt-0WyZMtssi4H2DD--EM/od6/public/values?alt=json&callback=?");

            var suggestions = new mExperience.offers.Suggestions({
                // Source for offers data
                data: offersSource,
                // Selectors / HTML elements / jQuery instances pointing to search inputs
                cuisine: "#cuisine",
                city: "#city",
                locality: "#locality"
            });

            offersSource.then(function(offersWrapper) {
                var offers = offersWrapper.data;
                var landingPageOffers = _.filter(offers, function(offer) { return offer.promoted; });
                var landingPageExclusives = _.filter(offers, function(offer) { return offer.exclusive; });

                window.mExperience.offers.render.landingPageOffers("#landing-page-offers", landingPageOffers);
                window.mExperience.offers.render.landingPageExclusives("#landing-page-exclusives", landingPageExclusives);
            });

            var btnGetSuggestions = jQuery('#get-suggestions');
            btnGetSuggestions.on('click', function() {
                // Render only offers matching filters
                suggestions.ready().then(function() {
                    var queries = _(suggestions.typeaheads).map(function(tt, key) {
                        return {key: key, value: tt.typeahead('val')};
                    }).filter(function(query) {
                        return query.value;
                    }).map(function(query) {
                        return [query.key, '=', query.value].join('');
                    }).value().join('&');
                    window.location = encodeURI("/mexperience/search.html?" + queries);
                    mExperience.offers.render.offersSearchResult("#offers-container", "#offer-results-count", suggestions.getOffers(true));
                });
            });

            jQuery('body').on('click.download.offer', '[data-id]', function(e) {
                var campaignId = jQuery(this).data('id');
                mExperience.offers.render.dataCollectionModal(campaignId);
            }).on('click.register.customer', '[data-campaign-id]', function(e) {
                var self = jQuery(this), campaignId = self.data('campaignId');
                mExperience.offers.api.registerCustomer(campaignId, self.parents('.modal-content').find('form')).then(function() {
                    mExperience.offers.render.thankYouModal();
                });
            });
        });
    </script>
</body>
</html>